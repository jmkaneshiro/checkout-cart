<h1>Products for Sale</h1>

<table>
  <tr>
    <th>Product</th>
    <th>Description</th>
    <th>Price</th>
    <th>Total In Stock</th>
    <th></th>
    <th></th>
  </tr>
  <% @products.each do |product|%>
    <% total_in_stock = product.inventory_items.where(purchased: false).size %>
    <tr>
      <td><%= product.name %></td>
      <td><%= product.description %></td>
      <td><%= number_to_currency(product.price) %></td>
      <td>
        <% if total_in_stock > 0 %>
          <%= total_in_stock %>
        <% else %>
          Out of stock
        <% end %>
      </td>
      <td>
        <% if total_in_stock > 0 %>
          <input type="number" name="product[qty]" id="product-qty" value="1" min="1" max="<%= total_in_stock %>">
        <% end %> 
      </td>
      <td>
        <% if total_in_stock > 0 %>
          <button type="submit">Add to Cart</button>
        <% end %>
      </td>
    </tr>
  <% end %>
</table>